{% extends 'base.html' %}
{% load static %}

{% block title %}Dashboard Paciente{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard_pacientes.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard-container" id="paciente-dashboard">
    <section class="dashboard-section perfil-paciente">
        <div class="section-header">
            <h2>Bienvenido, {{ paciente.user.first_name }} {{ paciente.user.last_name }}</h2>
        </div>
        <div class="section-content">
            <div id="perfil-info" class="info-card">
                <p><strong>Email:</strong> {{ paciente.user.email }}</p>
                {% if paciente.telefono %}
                <p><strong>Tel√©fono:</strong> {{ paciente.telefono }}</p>
                {% endif %}
                {% if paciente.historial_medico %}
                <p><strong>Historial m√©dico:</strong> {{ paciente.historial_medico }}</p>
                {% endif %}
            </div>
            <div id="medico-notes-widget" class="medico-notes-widget info-card"></div>
        </div>
    </section>
    
    <section class="dashboard-section calendario-citas">
        <div class="section-header">
            <h3>üìÖ Resumen de Citas</h3>
        </div>
        <div class="section-content">
            
                {% if citas %}
                    <table class="citas-table">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Hora</th>
                                <th>M√©dico</th>
                                <th>Descripci√≥n</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for cita in citas %}
                            <tr>
                                <td>{{ cita.fecha }}</td>
                                <td>{{ cita.hora }}</td>
                                <td>{{ cita.medico }}</td>
                                <td>{{ cita.description|default:"Sin descripci√≥n" }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <p>No tienes citas programadas.</p>
                    <div class="action-buttons">
                        <a href="{% url 'paciente_citas' %}" class="btn-primary">Agendar cita</a>
                    </div>
                {% endif %}
            
            <div id="historial-citas" class="info-card"></div>
        </div>
    </section>
    
    <section class="dashboard-section gestion-salud">
        <div class="section-header">
            <h3>ü©∫ Seguimiento de M√©tricas Vitales</h3>
        </div>
        <div class="section-content">
            <div class="metricas-container">
                {% if metria %}
                    <div class="metricas-grid">
                        <div class="metrica-card">
                            <h4>Estatura</h4>
                            <p>{{ metria.estatura }} cm</p>
                        </div>
                        <div class="metrica-card">
                            <h4>Peso</h4>
                            <p>{{ metria.peso }} kg</p>
                        </div>
                        <div class="metrica-card">
                            <h4>Presi√≥n Arterial</h4>
                            <p>{{ metria.presion_arterial }}</p>
                        </div>
                        <div class="metrica-card">
                            <h4>Frecuencia Card√≠aca</h4>
                            <p>{{ metria.frecuencia_cardiaca }} bpm</p>
                        </div>
                        <div class="metrica-card">
                            <h4>Tipo de Sangre</h4>
                            <p>{{ metria.tipo_sangre }}</p>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <a href="{% url 'paciente_metricas' %}" class="btn-secondary">Actualizar m√©tricas</a>
                    </div>
                {% else %}
                    <p>No tienes m√©tricas registradas.</p>
                    <div class="action-buttons">
                        <a href="{% url 'paciente_metricas' %}" class="btn-primary">Registrar m√©tricas</a>
                    </div>
                {% endif %}
            </div>
        </div>
    </section>
</div>
{% endblock %}

{% block footer %}
<footer>
    <button id="chatbot-btn">üí¨</button>
    <div id="chatbot-window">
        <div id="chatbot-header">ü§ñ Asistente Cu√≠dame</div>
        <div id="chatbot-messages"></div>
        <div id="chatbot-input">
            <input type="text" id="user-input" placeholder="Pregunta sobre citas, historial o medicamentos...">
            <button id="send-btn">Enviar</button>
        </div>
    </div>
</footer>
{% endblock %}

{% block scripts %}
<script src="{% static 'main/js/chatbot.js' %}"></script>
{% endblock %}
